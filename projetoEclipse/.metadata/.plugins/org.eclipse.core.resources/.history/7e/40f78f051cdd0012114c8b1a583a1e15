package aluno;

import java.sql.SQLException;

import javax.faces.bean.ManagedBean;
import javax.faces.bean.SessionScoped;

@ManagedBean(name="MBAluno")
@SessionScoped
public class MBAluno {
	
	private static MBAluno MBAluno = new MBAluno();
	private Aluno aluno;
	public MBAluno(){
		aluno = new Aluno();
	}

	public String cadastrarAluno() {
		String retorno="Usuário cadastrado com sucesso";
		AlunoDAOImpl daoAluno = new AlunoDAOImpl();
		daoAluno.save(aluno);
		return retorno;
	}

	public String apagarAluno() throws ClassNotFoundException, SQLException {
		// pega o parametro passado no link
		Integer id = Integer.parseInt((String)FacesContext.getCurrentInstance().getExternalContext().getRequestParameterMap().get("id"));
		String retorno ="";
		AlunoDAOImpl daoAluno = new AlunoDAOImpl();
		daoAluno.remove(aluno);
		return retorno;
	}

	public String editarAluno() throws ClassNotFoundException, SQLException{
		// pega o parametro passado no link
		Integer id = Integer.parseInt((String)FacesContext.getCurrentInstance().getExternalContext().getRequestParameterMap().get("id"));
		String retorno ="Usuário alterado com sucesso";
		//aluno = retornarAluno(id);

		AlunoDAOImpl daoAluno = AlunoDAOImpl.getInstance();
		daoAluno.editarAluno(aluno);			

		return retorno;
	}
	public Aluno retornarAluno(int id) throws ClassNotFoundException, SQLException{

		AlunoDAOImpl daoAluno = AlunoDAOImpl.getInstance();
		aluno = daoAluno.retornarAluno(id);
		return aluno;
		
	}
	public Aluno retornarAluno() throws ClassNotFoundException, SQLException{

		Integer id = Integer.parseInt((String)FacesContext.getCurrentInstance().getExternalContext().getRequestParameterMap().get("id"));
		AlunoDAOImpl daoAluno = AlunoDAOImpl.getInstance();
		aluno =  daoAluno.retornarAluno(id);
		return aluno ;
		//return AlunoDAOImpl.getInstance().retornarAluno(matricula);
	}
	public List<Aluno> getAlunos() throws ClassNotFoundException, SQLException{
		List<Aluno> lista = new ArrayList<Aluno>();
		AlunoDAOImpl daoAluno = AlunoDAOImpl.getInstance();
		lista = daoAluno.retornarAlunos();
		return lista;
	}

	public Aluno getAluno() {
		return aluno;
	}

	public void setAluno(Aluno aluno) {
		this.aluno = aluno;
	}

	// MÉTODOS DE NAVEGAÇÃO...

	public String novo() {
		aluno = new Aluno();
		return "CadastroAluno.jsp";
	}
	public String editar() {
		try {
			retornarAluno();
		} catch (ClassNotFoundException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		return "CadastroAluno.jsp";
	}

	public String salvar() {
		cadastrarAluno();
		return "ListagemAluno.jsp";
	}

}
